import React, { useState } from 'react';
import { 
  Calendar, 
  MapPin, 
  Home, 
  Navigation, 
  ChevronDown, 
  ChevronUp, 
  CheckCircle, 
  AlertTriangle, 
  Wind, 
  Coffee, 
  Trees, 
  Waves,
  Camera,
  Moon,
  ExternalLink,
  Clock,
  Info
} from 'lucide-react';

const App = () => {
  const [activeTab, setActiveTab] = useState('days');
  const [openAccordion, setOpenAccordion] = useState('morning');
  const [lunchOption, setLunchOption] = useState('A'); // 'A' for Fairfax, 'B' for Cottage

  // Color Palette Constants
  const colors = {
    bg: '#E8ECEB',
    text: '#2D3A30',
    accent: '#D97706',
  };

  const NavigateButton = ({ url }) => (
    <a 
      href={url} 
      target="_blank" 
      rel="noopener noreferrer"
      className="flex items-center justify-center gap-2 w-full py-3 mt-3 bg-white border border-gray-200 rounded-xl shadow-sm hover:bg-gray-50 active:scale-95 transition-all text-sm font-medium"
      style={{ color: colors.text }}
    >
      <Navigation size={16} className="text-emerald-700" />
      Navigate
    </a>
  );

  const VerifiedBadge = () => (
    <span className="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-800 text-[10px] font-bold uppercase tracking-wider">
      <CheckCircle size={10} />
      Verified
    </span>
  );

  const DaySection = ({ title, date, children }) => (
    <div className="mb-8">
      <div className="sticky top-16 z-10 py-3 mb-4 bg-[#E8ECEB]/90 backdrop-blur-sm border-b border-gray-200">
        <h2 className="font-serif text-2xl font-bold" style={{ color: colors.text }}>{title}</h2>
        <p className="text-xs font-medium opacity-60 uppercase tracking-widest">{date}</p>
      </div>
      {children}
    </div>
  );

  const TimelineItem = ({ time, title, description, location, icon: Icon, warning, verified }) => (
    <div className="relative pl-8 pb-8 border-l border-emerald-900/10 last:border-0 last:pb-0">
      <div className="absolute -left-3 top-0 p-1.5 rounded-full bg-white border border-emerald-100 shadow-sm" style={{ color: colors.accent }}>
        {Icon ? <Icon size={14} /> : <div className="w-3.5 h-3.5" />}
      </div>
      <div className="flex flex-col gap-1">
        <div className="flex items-center justify-between">
          <span className="text-xs font-bold font-sans tracking-tighter opacity-50 uppercase">{time}</span>
          {verified && <VerifiedBadge />}
        </div>
        <h3 className="font-serif text-lg font-semibold leading-tight" style={{ color: colors.text }}>{title}</h3>
        <p className="text-sm opacity-80 leading-relaxed font-sans mt-1">{description}</p>
        
        {warning && (
          <div className="mt-2 p-3 bg-amber-50 border border-amber-200 rounded-lg flex gap-3">
            <AlertTriangle size={18} className="text-amber-600 shrink-0" />
            <p className="text-xs text-amber-900 leading-normal">{warning}</p>
          </div>
        )}

        {location && <NavigateButton url={location} />}
      </div>
    </div>
  );

  return (
    <div className="min-h-screen font-sans pb-32" style={{ backgroundColor: colors.bg, color: colors.text }}>
      
      {/* PERSISTENT HEADER: HOME BASE */}
      <header className="sticky top-0 z-30 px-6 py-4 bg-[#E8ECEB]/95 backdrop-blur-md border-b border-gray-200 shadow-sm">
        <div className="flex items-center justify-between">
          <div>
            <h1 className="font-serif text-xl font-bold italic">Creamery Cottage</h1>
            <p className="text-[10px] font-medium opacity-60 uppercase tracking-tighter">San Geronimo · Jan 1–3, 2026</p>
          </div>
          <div className="flex flex-col items-end">
            <span className="text-[10px] uppercase font-bold text-emerald-700">Check-in</span>
            <span className="text-sm font-serif font-bold">4:00 PM</span>
          </div>
        </div>
      </header>

      <main className="px-6 pt-6">
        {activeTab === 'days' && (
          <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
            {/* THURSDAY */}
            <DaySection title="Arrival & Landing" date="Thursday, Jan 1">
              <TimelineItem 
                time="4:00 PM" 
                title="Check-in" 
                description="Unpack lightly. Let the place go quiet."
                icon={Home}
                location="https://maps.google.com/?q=38.01183,-122.66805"
              />
              <TimelineItem 
                time="4:30 PM" 
                title="Neighborhood Road Walk" 
                description="No destination. Just shake off the drive."
                icon={Trees}
              />
              <TimelineItem 
                time="7:00 PM" 
                title="Station House Café" 
                description="Historic room, low light, slow pacing. Your New Year’s anchor."
                icon={Moon}
                verified
                location="https://maps.google.com/?q=Station+House+Cafe+Point+Reyes+Station"
              />
            </DaySection>

            {/* FRIDAY ACCORDION */}
            <DaySection title="Redwoods & Coast" date="Friday, Jan 2">
              <div className="space-y-4 mb-4">
                {/* MORNING */}
                <div className="bg-white/50 border border-gray-200 rounded-2xl overflow-hidden shadow-sm">
                  <button 
                    onClick={() => setOpenAccordion(openAccordion === 'morning' ? null : 'morning')}
                    className="w-full px-5 py-4 flex items-center justify-between text-left"
                  >
                    <div className="flex items-center gap-3">
                      <Trees className="text-emerald-700" size={20} />
                      <span className="font-serif font-bold">Morning: Roy's Redwoods</span>
                    </div>
                    {openAccordion === 'morning' ? <ChevronUp size={20}/> : <ChevronDown size={20}/>}
                  </button>
                  {openAccordion === 'morning' && (
                    <div className="px-5 pb-5 animate-in slide-in-from-top-2 duration-300">
                      <p className="text-sm mb-4">Flat trails, creek crossings, real quiet. 45–90 minutes.</p>
                      <NavigateButton url="https://maps.google.com/?q=Roy%27s+Redwoods+Preserve" />
                    </div>
                  )}
                </div>

                {/* LUNCH CHOICE CARDS */}
                <div className="bg-white/50 border border-gray-200 rounded-2xl overflow-hidden shadow-sm">
                  <div className="px-5 py-4 border-b border-gray-100 flex items-center justify-between">
                    <div className="flex items-center gap-3">
                      <Coffee className="text-emerald-700" size={20} />
                      <span className="font-serif font-bold">Lunch Options</span>
                    </div>
                    <div className="flex bg-gray-200 p-1 rounded-lg">
                      <button 
                        onClick={() => setLunchOption('A')}
                        className={`px-3 py-1 text-[10px] font-bold uppercase rounded-md transition-all ${lunchOption === 'A' ? 'bg-white shadow-sm' : 'opacity-50'}`}
                      >Fairfax</button>
                      <button 
                        onClick={() => setLunchOption('B')}
                        className={`px-3 py-1 text-[10px] font-bold uppercase rounded-md transition-all ${lunchOption === 'B' ? 'bg-white shadow-sm' : 'opacity-50'}`}
                      >Cottage</button>
                    </div>
                  </div>
                  <div className="p-5">
                    {lunchOption === 'A' ? (
                      <div className="space-y-3">
                        <p className="text-xs font-medium uppercase opacity-50 mb-2">Fairfax (10 min away)</p>
                        <div className="grid grid-cols-1 gap-2">
                          <a href="https://maps.google.com/?q=Good+Earth+Natural+Foods+Fairfax" target="_blank" className="p-3 bg-white rounded-xl border border-gray-100 flex items-center justify-between">
                            <span className="text-sm font-medium">Good Earth Foods</span>
                            <ExternalLink size={14} className="opacity-30" />
                          </a>
                          <a href="https://maps.google.com/?q=Barefoot+Cafe+Fairfax" target="_blank" className="p-3 bg-white rounded-xl border border-gray-100 flex items-center justify-between">
                            <span className="text-sm font-medium">Barefoot Café</span>
                            <ExternalLink size={14} className="opacity-30" />
                          </a>
                        </div>
                      </div>
                    ) : (
                      <div className="flex flex-col items-center py-4 text-center">
                        <Home className="mb-2 opacity-20" size={32} />
                        <p className="text-sm font-medium italic">Easy afternoon back at the cottage base.</p>
                      </div>
                    )}
                  </div>
                </div>

                {/* AFTERNOON */}
                <div className="bg-white/50 border border-gray-200 rounded-2xl overflow-hidden shadow-sm">
                  <button 
                    onClick={() => setOpenAccordion(openAccordion === 'afternoon' ? null : 'afternoon')}
                    className="w-full px-5 py-4 flex items-center justify-between text-left"
                  >
                    <div className="flex items-center gap-3">
                      <Waves className="text-emerald-700" size={20} />
                      <span className="font-serif font-bold">Afternoon: Coastal Loop</span>
                    </div>
                    {openAccordion === 'afternoon' ? <ChevronUp size={20}/> : <ChevronDown size={20}/>}
                  </button>
                  {openAccordion === 'afternoon' && (
                    <div className="px-5 pb-5 space-y-6 animate-in slide-in-from-top-2 duration-300">
                      <div>
                        <div className="flex items-center gap-2 mb-1">
                          <div className="w-5 h-5 rounded-full bg-emerald-900 text-white flex items-center justify-center text-[10px] font-bold">1</div>
                          <h4 className="font-bold text-sm">Chicken Ranch Beach</h4>
                        </div>
                        <p className="text-xs opacity-70 italic mb-2">Flat bay walk. Calm water. Reset.</p>
                        <NavigateButton url="https://maps.google.com/?q=38.0709,-122.8795" />
                      </div>

                      <div>
                        <div className="flex items-center gap-2 mb-1">
                          <div className="w-5 h-5 rounded-full bg-emerald-900 text-white flex items-center justify-center text-[10px] font-bold">2</div>
                          <h4 className="font-bold text-sm">Cypress Tree Tunnel</h4>
                        </div>
                        <p className="text-xs opacity-70 italic mb-2">Visual punctuation — 10-15 mins.</p>
                        <NavigateButton url="https://maps.google.com/?q=Cypress+Tree+Tunnel" />
                      </div>

                      <div>
                        <div className="flex items-center gap-2 mb-1">
                          <div className="w-5 h-5 rounded-full bg-emerald-900 text-white flex items-center justify-center text-[10px] font-bold">3</div>
                          <h4 className="font-bold text-sm">Point Reyes Lighthouse</h4>
                        </div>
                        <p className="text-xs opacity-70 italic mb-2">Closes ~4 PM. Dramatic cliffs.</p>
                        <div className="mt-2 p-3 bg-amber-50 border border-amber-200 rounded-lg flex gap-3 mb-2">
                          <AlertTriangle size={18} className="text-amber-600 shrink-0" />
                          <p className="text-xs text-amber-900">300+ steps down (and back up). Wind is serious. Stay only while it feels powerful.</p>
                        </div>
                        <NavigateButton url="https://maps.google.com/?q=Point+Reyes+Lighthouse" />
                      </div>
                    </div>
                  )}
                </div>

                {/* EVENING */}
                <div className="bg-white/50 border border-gray-200 rounded-2xl overflow-hidden shadow-sm">
                  <button 
                    onClick={() => setOpenAccordion(openAccordion === 'evening' ? null : 'evening')}
                    className="w-full px-5 py-4 flex items-center justify-between text-left"
                  >
                    <div className="flex items-center gap-3">
                      <Moon className="text-emerald-700" size={20} />
                      <span className="font-serif font-bold">Evening: Back Inland</span>
                    </div>
                    {openAccordion === 'evening' ? <ChevronUp size={20}/> : <ChevronDown size={20}/>}
                  </button>
                  {openAccordion === 'evening' && (
                    <div className="px-5 pb-5 animate-in slide-in-from-top-2 duration-300">
                      <p className="text-sm mb-4 italic">Dinner at cottage or Fairfax options like Fradelizio’s or Gestalt Haus.</p>
                      <div className="flex items-center gap-2 text-xs font-medium text-emerald-800">
                        <Info size={14} />
                        Drive back before dark recommended.
                      </div>
                    </div>
                  )}
                </div>
              </div>
            </DaySection>

            {/* SATURDAY */}
            <DaySection title="Leave Clean" date="Saturday, Jan 3">
              <TimelineItem 
                time="Morning" 
                title="Slow Start" 
                description="Coffee, pack slowly, one last short road walk."
                icon={Coffee}
              />
              <TimelineItem 
                time="11:00 AM" 
                title="Check-out" 
                description="Leave without squeezing. That’s success."
                icon={ExternalLink}
                location="https://maps.google.com/?q=38.01183,-122.66805"
              />
            </DaySection>
          </div>
        )}

        {activeTab === 'map' && (
          <div className="animate-in fade-in slide-in-from-bottom-4 duration-500 pb-10">
            <h2 className="font-serif text-2xl font-bold mb-6">Quick Links</h2>
            <div className="space-y-3">
              {[
                { name: "Creamery Cottage", url: "https://maps.google.com/?q=38.01183,-122.66805" },
                { name: "Station House Café", url: "https://maps.google.com/?q=Station+House+Cafe+Point+Reyes+Station" },
                { name: "Roy’s Redwoods", url: "https://maps.google.com/?q=Roy%27s+Redwoods+Preserve" },
                { name: "Chicken Ranch Beach", url: "https://maps.google.com/?q=38.0709,-122.8795" },
                { name: "Cypress Tree Tunnel", url: "https://maps.google.com/?q=Cypress+Tree+Tunnel" },
                { name: "Point Reyes Lighthouse", url: "https://maps.google.com/?q=Point+Reyes+Lighthouse" },
              ].map((loc, i) => (
                <a key={i} href={loc.url} target="_blank" rel="noopener noreferrer" className="flex items-center justify-between p-4 bg-white rounded-2xl shadow-sm border border-gray-200">
                  <div className="flex items-center gap-3">
                    <MapPin size={18} className="text-emerald-700" />
                    <span className="font-medium text-sm">{loc.name}</span>
                  </div>
                  <Navigation size={16} className="opacity-30" />
                </a>
              ))}
            </div>
          </div>
        )}

        {activeTab === 'info' && (
          <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
            <h2 className="font-serif text-2xl font-bold mb-6">Cottage Details</h2>
            <div className="bg-white p-6 rounded-3xl shadow-sm border border-gray-200 space-y-6">
              <div>
                <h4 className="text-[10px] font-bold uppercase opacity-50 mb-2">Location</h4>
                <p className="font-serif text-lg leading-tight">San Geronimo / Lagunitas, CA 94963</p>
              </div>
              <div>
                <h4 className="text-[10px] font-bold uppercase opacity-50 mb-2">Expectations</h4>
                <ul className="space-y-3">
                  {[
                    "Quiet rural road & redwoods",
                    "Creeks & wildlife viewing",
                    "Fire pit available (weather permitting)",
                    "Strictly no parties"
                  ].map((text, i) => (
                    <li key={i} className="flex items-center gap-3 text-sm">
                      <div className="w-1.5 h-1.5 rounded-full bg-emerald-600" />
                      {text}
                    </li>
                  ))}
                </ul>
              </div>
              <div className="grid grid-cols-2 gap-4 pt-4 border-t border-gray-100">
                <div>
                  <h4 className="text-[10px] font-bold uppercase opacity-50 mb-1">Check-in</h4>
                  <p className="text-sm font-bold">Jan 1, 4:00 PM</p>
                </div>
                <div>
                  <h4 className="text-[10px] font-bold uppercase opacity-50 mb-1">Check-out</h4>
                  <p className="text-sm font-bold">Jan 3, 11:00 AM</p>
                </div>
              </div>
            </div>
          </div>
        )}
      </main>

      {/* BOTTOM NAVIGATION */}
      <nav className="fixed bottom-6 left-6 right-6 z-50">
        <div className="bg-[#2D3A30]/90 backdrop-blur-xl border border-white/10 rounded-full shadow-2xl px-2 py-2 flex items-center justify-between">
          <button 
            onClick={() => setActiveTab('days')}
            className={`flex-1 flex flex-col items-center py-2 transition-all rounded-full ${activeTab === 'days' ? 'bg-white/10 text-white' : 'text-white/40'}`}
          >
            <Calendar size={20} />
            <span className="text-[10px] mt-1 font-bold uppercase tracking-tighter">Itinerary</span>
          </button>
          
          <button 
            onClick={() => setActiveTab('map')}
            className={`flex-1 flex flex-col items-center py-2 transition-all rounded-full ${activeTab === 'map' ? 'bg-white/10 text-white' : 'text-white/40'}`}
          >
            <MapPin size={20} />
            <span className="text-[10px] mt-1 font-bold uppercase tracking-tighter">Places</span>
          </button>
          
          <button 
            onClick={() => setActiveTab('info')}
            className={`flex-1 flex flex-col items-center py-2 transition-all rounded-full ${activeTab === 'info' ? 'bg-white/10 text-white' : 'text-white/40'}`}
          >
            <Home size={20} />
            <span className="text-[10px] mt-1 font-bold uppercase tracking-tighter">Cottage</span>
          </button>
        </div>
      </nav>

    </div>
  );
};

export default App;
